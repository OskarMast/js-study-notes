<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>React - Context</title>
</head>
<body>
<div id="root"></div>
<div id="server"></div>
<div id="demo"></div>
<script src="./node_modules/babel-standalone/babel.js"></script>
<script src="./node_modules/react/umd/react.development.js"></script>
<script src="./node_modules/react-dom/umd/react-dom.development.js"></script>
<script type="text/babel">
/*    class App extends React.Component {
        render(){
            return (
                <Toolbar theme="dark"/>
            )
        }
    }
    function Toolbar(props){
        return (
            <div>
                <ThemedButton theme={props.theme}/>
            </div>
        )
    }
    class ThemedButton extends React.Component {
        render() {
            return (
                <Button theme={this.props.theme}/>
            )
        }
    }*/
    // 使用context,可以避免通过中间元素传递props

    const ThemeContext = React.createContext("light");
    class App extends React.Component {
        render(){
            return (
                <ThemeContext.Provider value="dark">
                    <Toolbar/>
                </ThemeContext.Provider>
            )
        }
    }
    // 中间的组件也不必指明往下传递theme
    function Toolbar(){
        return (
            <div>
                <ThemedButton/>
            </div>
        )
    }
    class ThemedButton extends React.Component {
        static contextType = ThemeContext;
        render(){
            return (
                <Button theme={this.context}/>
            )
        }
    }

    /*
    *   在Association 组件里使用了 Lakers组件,将数据传递给Lakers组件
    *   Lakers组件里使用了 Player组件, 将接受到到数据 再次传递给 Player组件
    *   Player组件接受到数据后使用
    * */
/*    class Association extends React.Component {
        render (){
            return (
                <Lakers player="lebron"/>
            )
        }
    }
    function Lakers(props){
        console.log(props);
        return (
            <Player player={props.player}/>
        )
    }

    class Player extends React.Component {
        constructor(props){
            super(props);
        }
        render(){
            console.log(this.props);
            return (
                <div>
                    <p>{this.props.player}</p>
                </div>
            )
        }
    }
    ReactDOM.render(
        <Association/>,
        document.getElementById("root")
    )*/


    const PlayerContext = React.createContext("lebron");
    class Association extends React.Component {
        constructor(props){
            super(props);
            this.state = {
                value:"lebron"
            }
        }
        handleChange = () => {
            this.setState({value:"kyrie"})
        }
        render(){
            return (
                <PlayerContext.Provider value={this.state.value}>
                    <Lakers/>
                    <button onClick={this.handleChange}>change</button>
                </PlayerContext.Provider>
            )
        }
    }

    class Lakers extends React.Component {
        static contextType = PlayerContext;
        render(){
            console.log(this.context);
            return (
                <Player/>
            )
        }
    }

    class Player extends React.Component{
        static contextType = PlayerContext;
        render(){
            console.log(this.context);
            console.log(Player.contextType);
            return (
                <div>
                    {this.context}
                </div>
            )
        }
    }

    ReactDOM.render(
        <Association/>,
        document.getElementById("server")
    )

    const MyContext = React.createContext('defaultValue');
    class MyClass extends React.Component {
        componentDidMount() {
            let value = this.context;
            console.log('componentDidMount:',value);
        }
        componentDidUpdate() {
            let value = this.context;
            console.log('componentDidUpdate:',value);
        }
        componentWillUnmount() {
            let value = this.context;
            console.log('componentWillUnmount:',value);
        }
        static contextType = MyContext;
        render() {
            let value = this.context;
            console.log("render:",value);
            return (
                <div>{this.context}</div>
            )
        }
    }

    class Demo extends React.Component {
        render(){
            return (
                <MyContext.Provider value="my-class">
                    <MyClass/>
                </MyContext.Provider>
            )
        }
    }

    ReactDOM.render(
        <Demo/>,
        document.getElementById("demo")
    )












</script>
</body>
</html>