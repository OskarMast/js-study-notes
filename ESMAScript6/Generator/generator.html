<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title>generator函数</title>
	</head>
	<body>
		<script>
			// for...of 循环 可以自动遍历Generator函数运行时生成的Iterator对象,
			function* foo(){
				yield 1;
				yield 2;
				yield 3;
				yield 4;
			}
			for(let v of foo()){
				console.log(v);
			}
			
			
			function* objectEntries(obj){
				let propKeys = Reflect.ownKeys(obj);
				for(let propKey of propKeys){
					yield [propKey,obj[propKey]];
				}
			}
			
			let jane = {first:"Jane",last:"Doe"};
			for(let [key,value] of objectEntries(jane)){
				console.log(`${key}:${value}`);
			}
			
			console.log(Object.entries(jane));
			console.log(Object.keys(jane));
			console.log(Object.values(jane))
			
			
			let player = {
				firstName:"kyrie",
				lastName:"irving",
				age:26
			}
			
			function* playerGenerator(obj){
				let propKeys = Object.keys(obj);
				for(let value of propKeys){
					yield [value,obj[value]]
				}
			}
			for(let [key,value] of playerGenerator(player)){
				console.log(key,value);
			}
			
			
			/* 除了for...of 循环,扩展运算符(...) 解构赋值 和 Array.from方法内部调用的,都是遍历器接口.
			它们都可以将Generator函数返回的Iterator对象,作为参数.*/ 
			
			function* numbers(){
				yield 1
				yield 2
				return 3;
				yield 4
			}
			console.log([...numbers()])	// [1,2]
			console.log(Array.from(numbers()));	// [1,2]
			Array.from(numbers(),el=>{
				console.log(el)
			})
			let [x,y] = numbers();
			console.log(x,y);
			
			function* gen(){
				yield 'hello'
				yield 'world'
			}
			let g1 = gen();
			console.log( g1.next() );	// {value:'hello',done:false}
			console.log( g1.return('china') );	// {value:'china',done:true}
			console.log(g1.next());	// {value:undefined,done:true}
			
			
			// yield* 表达式
			function* f1(){
				yield "a";
				yield "b";
			}
			function* f2(){
				yield "x";
				for(let item of f1()){
					yield item;
				}
				yield "y"
			}
			for(let item of f2()){
				console.log(item);	// a b x y
			}
			
			function* m1(){
				yield "a";
				yield "b";
			}
			function* m2(){
				yield "x";
				yield* m1();
				yield "y";
			}
			for(let v of m2()){
				console.log(v);
			}
			
			let delegatedIterator = (function* (){
				yield "Hello";
				yield "Bye";
			}())
			
			let delegatingIterator = (function* (){
				yield "Greeting";
				yield* delegatedIterator;
				yield "OK bye"
			}());
			
			for(let value of delegatingIterator){
				console.log(value);
			}
			
			// Generator函数的this
			
		</script>
	</body>
</html>
