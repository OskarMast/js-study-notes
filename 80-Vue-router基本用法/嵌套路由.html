<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <style>
        #app{
            margin:30px auto;
            width:500px;
            height:400px;
            border:1px solid #f1f1f1;
        }
        ul,ol{
            margin: 0;
            padding: 0;
            list-style:none;
        }
        a{
            text-decoration:none;
            color:#333;
        }
        .nav-list{
            height:40px;
            display:flex;
            background-color:skyblue;
        }
        .nav-list .nav-item{
            flex:1;
            height:40px;
            text-align:center;
            line-height:40px;
        }
        .resource-wrapper{
            display:flex;
            height:360px;
        }
        .resource-wrapper>ul{
            width:100px;
            height:100%;
            border-right:1px solid #f1f1f1;
        }
        .resource-wrapper .resource-item{
            height:40px;
            line-height:40px;
        }
        .nav-item .active{
            color:#f00;
        }
        .resource-item .active{
            color:#f00;
        }
    </style>
</head>
<body>
<div id="app">
    <ul class='nav-list'>
        <li class="nav-item"><router-link to="/study">学习</router-link></li>
        <li class="nav-item"><router-link to="/system">生态系统</router-link></li>
        <li class="nav-item"><router-link to="/resource">资源列表</router-link></li>
    </ul>
    <router-view></router-view>
</div>
<script src="https://unpkg.com/vue/dist/vue.js"></script>
<script src="https://unpkg.com/vue-router/dist/vue-router.js"></script>
<script>

    const study = {
        template:`<div>
            <router-link :to="{name:'book',params:{page:1}}">教程</router-link>
            <router-link :to="{name:'book',params:{page:2}}">api</router-link>
            <router-view></router-view>
        </div>`,
        beforeCreate(){
            console.log('study beforeCreate');
        },
        created(){
            document.title = this.$route.meta.title;
        },
        beforeRouteEnter(to,from,next){
            console.log('study beforeRouteEnter');
            next();
        },
    }
    const book = {
        template:`<div>{{this.$route.meta.title}}---{{this.$route.params.page}}</div>`,
        data(){
            return {
                name:'book'
            }
        },
        beforeRouteEnter(to,from,next){
            console.log('book  beforeRouteEnter');
            console.log(to,from,this.name);
            next((vm) => {
                console.log('beforeRouteEnter中访问vue实例:', vm.name);
            });
        },
        beforeRouteUpdate(to,from,next){
            console.log('book  beforeRouteUpdate');
            console.log(to,from,this.name);
            next();
        },
        beforeRouteLeave(to,from,next){
            console.log('book  beforeRouteLeave')
            console.log(to,from,this.name);
            next();
        }
    }
    const system = {
        template:`<div>生态系统</div>`,
        created(){
            document.title = this.$route.meta.title;
            console.log('system created');
        }
    }
    const resource = {
        template:`<div class="resource-wrapper">
            <ul class="resource-list">
                <li class="resource-item"><router-link to="/resource/partner">合作伙伴</router-link></li>
                <li class="resource-item"><router-link to="/resource/theme">主题</router-link></li>
            </ul>
            <router-view></router-view>
        </div>`,
        created(){
            document.title = this.$route.meta.title;
        }
    }

    const partner = {
        template:`<div>合作伙伴</div>`
    };

    const theme = {
        template:`<div>主题</div>`
    }

    const router = new VueRouter({
        linkActiveClass:'active',
        routes:[
            {
                path:'/study',
                component:study,
                name:'study',
                meta:{
                    title:'study'
                },
                beforeEnter(to,from,next){
                    console.log('study beforeEnter');
                    next();
                },
                children:[
                    {
                        path:'/study/:page',
                        name:'book',
                        component:book,
                        meta:{title:'教程'},
                        beforeEnter(to,from,next){
                            console.log('book beforeEnter');
                            next();
                        }
                    }
                ]
            },
            {
                path:'/system',
                component:system,
                name:'system',
                meta:{title:'system'}
            },
            {
                path:'/resource',
                component:resource,
                name:'resource',
                meta:{title:'resource'},
                children:[
                    {
                        path:'partner',
                        component:partner,
                        name:'partner'
                    },
                    {
                        path:'theme',
                        component:theme,
                        name:'theme'
                    }
                ]
            },
            {
                path:'/*',
                redirect:'/study'
            }
        ]
    })
    router.beforeEach((to,from,next)=>{
        console.log('beforeEach');
        next()
    })

    router.beforeResolve((to,from,next) => {
        console.log('beforeResolve');
        next();
    })

    router.afterEach((to,from) => {
        console.log('afterEach');
    })
    const vm = new Vue({
        el:'#app',
        router
    })
</script>
</body>
</html>