<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title>drag案例</title>
		<style>
			body,ul,ol,p{
				padding: 0;
				margin: 0;
			}
			ul,ol{
				list-style:none;
			}
			body{
				background-color:#ccc;
			}
			.container{
				margin:50px auto 0;
				padding:0 20px 20px;
				width: 800px;
				height: auto;
				background-color:#fff;
				overflow:hidden;
				border-radius:5px;
			}
			.progress{
				width: 100%;
				height:50px;
			}
			.area{
				width: 800px;
				height: 120px;
				background-color:#eee;
				color:#bbb;
				line-height:120px;
			}
			.area,.submit{
				text-align:center;
			}
			.submit{
				margin:10px 0 10px auto;
				width: 80px;
				height: 40px;
				background-color:skyblue;
				color:#fff;
				line-height:40px;
				border-radius:5px;
				cursor:pointer;
			}
			.list{
				width: 800px;
				min-height:300px;
				border:1px solid #000;
				overflow:hidden;
			}
			.list>li>img{
				display:block;
				float:left;
				width: 200px;
				height:180px;
			}
		</style>
	</head>
	<body>
		<div class="container">
			<div class="progress"></div>
			<section class='area'>将图片拖入此处</section>
			<div class='submit' onselectstart = 'return false'>开始上传</div>
			<ul class="list">
			</ul>
		</div>
		<script>
			const oArea = document.querySelector('.area');
			const oList = document.querySelector('.list');
			const oText = document.querySelector('.text');
			/*
			功能实现:
			1. 拖拽文件到指定区域,该区域文本显示为释放鼠标
			1.1 利用H5的拖拽drag和drop事件
			1.2 利用拖拽事件的dataTransfer获取拖拽的数据
			1.2 读取拖拽的数据,并用数组遍历的方法遍历
			1.3 创建图片标签,将数据设置为图片的src属性,再添加至ul
			*/
		   oArea.addEventListener('dragenter',drag,false);
		   oArea.addEventListener('dragover',drag,false);
		   oArea.addEventListener('drop',drag,false);
			
			function drag(event){
				event = event || window.event;
				event.preventDefault();
				let type = event.type;
				switch(type){
					case 'dragenter':
					oArea.innerHTML = '释放鼠标';
					break;
					case 'dragover':
					break;
					case 'drop':
					oArea.innerHTML = '将图片拖入此处';
					let data = event.dataTransfer.files;
					// 获取拖拽文件的数据,是一个对象,将对象转换位数组遍历,以下方法都可以将对象转换为数组
// 					[...data].forEach(function(item){
// 						console.log(item);
// 					});
// 					Object.values(data);
// 					Array.from( data );
/*					利用for循环遍历,
					for(let i = 0,len = data.length; i < len; i++){
						let fileRead = new FileReader();
						fileRead.readAsDataURL( data[i] );
						fileRead.addEventListener('load',function(){
							console.log(fileRead.result);
						},false);
					}
					for循环的另一种写法,
					for(let i = 0, file; file = data[i]; i++){
						let fileRead = new FileReader();
						fileRead.readAsDataURL(file);
						fileRead.addEventListener('load',function(){
							console.log(fileRead.result);
						},false);
					}*/
					Array.prototype.forEach.call(data,function(item){
						let fileRead = new FileReader();
						fileRead.readAsDataURL(item);
						fileRead.addEventListener('load',function(){
							console.log(fileRead.result);
							// 需要在load事件后才能读取fileRead.result
							let aLi = document.createElement('li');
							aLi.innerHTML = `<img src=${fileRead.result}>`;
							oList.appendChild(aLi);
						},false);
					});
					break;
				}
			}
		</script>
	</body>
</html>
