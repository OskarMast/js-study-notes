<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Ajax同源上传文件</title>
    <style>
        body{
            padding: 0;
            margin: 0;
        }
        label{
            display:block;
            width:100px;
            font-size:14px;
            color:#fff;
            height:28px;
            line-height:28px;
            text-align:center;
            background-color:skyblue;
        }
        input[type='file']{
            display:none;
        }
    </style>
</head>
<body>
    <p>账号：<input type="text" name="username" class='username' placeholder="请输入姓名"></p>
    <p>密码：<input type="text" name="password" class='password' placeholder="请输入密码"></p>
    <label for="input">选择头像</label>
    <input type="file" multiple id="input">
    <p><input type="submit" value="提交" class="button"></p>
<script>
    const btn = document.querySelector(".button");
    const username = document.querySelector(".username");
    const password = document.querySelector(".password");
    const avatar = document.querySelector("#input");
    let formData = new FormData();
    avatar.onchange = function(){
        if(avatar.value){
            console.log(avatar.files);
            for(let i = 0; i < avatar.files.length;i++){
                formData.append('file',avatar.files[i]);
            }
        }
    }
    btn.addEventListener("click",() => {
        const xhr = new XMLHttpRequest();
        xhr.open("post","http://localhost:3000/upload",true);
        formData.append("username",username.value);
        formData.append("password",password.value);
        xhr.send(formData);
    },false);
</script>
</body>
</html>