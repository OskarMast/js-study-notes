<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title>Vue.nextTick</title>
	</head>
	<body>
		<div id="demo">{{message}}</div>
		<div id="app">
			<example></example>
		</div>

		<div id="parent">
			<son ref="son"></son>
		</div>

		<script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
		<script>
			const vm = new Vue({
				el:"#demo",
				data:{
					message:"Hello World!"
				}
			});
			vm.message = "new message";
			console.log(vm.$el.innerText);	// Hello World;	还未更新
			console.log(vm.$el.textContent);	// Hello World;	还未更新

			vm.$nextTick(()=>{
				console.log(vm.$el.textContent);	// new message
			});


			const example = Vue.component("example",{
				template:`<div>
					<p class='text'>{{message}}</p>
					<button @click='updateMsg'>更新数据</button>
				</div>`,
				data(){
					return{
						message:"未更新"
					}
				},
				methods:{
					updateMsg(){
						this.message = "已更新",
						console.log(this.$el.innerText);	// 未更新
						this.$nextTick(()=>{
							console.log(this.$el.innerText);
						})
					}
				}
			});
			new Vue({
				el:document.getElementById("app"),
				components:{
					example
				}
			});


			/* 根组件是parent,子组件是son*/
			const son = {
				template:`<div>
					{{msg}}
				</div>`,
				data(){
					return {
						msg:'我是子组件数据'
					}
				},
				mounted(){
					this.msg = '我是挂载后更新的数据'
				},
			}

			new Vue({
				el:'#parent',
				components:{son},
				mounted(){
					console.log('msg:',this.$refs.son.$el.textContent);	// 我是子组件数据
					console.log('el:',this.$refs.son.$el);
					/* this.$nextTick(() => {
						console.log(this.$refs.son.$el.textContent);
					});
					*/
					this.$nextTick().then(() => {
						console.log('msg:',this.$refs.son.$el.textContent);	// 我是挂载后更新的数据
						console.log('el:',this.$refs.son.$el);
					})
				}
			})
		</script>
	</body>
</html>
