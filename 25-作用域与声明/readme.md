
# 理解作用域

    对于JavaScript来说,大部分情况下编译发生在代码执行前的几微秒（甚至更短）的时间内。任何JavaScript代码片段在执行前
    都要进行编译(通常就在执行前),因此,JavaScript编译器首先会对 var a = 2;进行编译,然后做好执行它的准备。
    
    1. 引擎
        负责整个JavaScript程序的编译及执行过程。
    2. 编译器
        负责愈发分析及代码生成
    3.  作用域
        负责收集并维护由所有声明的标识符组成的一系列查询,并实施一套非常严格的规则，确定当前执行的代码对这些标识符的访问权限。
        
# JS引擎查找变量的方式

    LHS和RHS
    当变量出现在复制操作的左侧时进行LHS查询,出现在非左侧进行RHS查询。可以将其理解为 
    赋值操作的目标是谁(LHS) 以及 谁是赋值操作的源头(RHS)。
    
    当一个块或者函数 嵌套 在另一个 块或者函数中时，就发生了作用域的嵌套。因此,在当前作用域中无法找到某个变量时,引擎就会
    在外层嵌套的作用域中继续查找。直到找到该变量为止。
    
## 异常

    在变量没有声明(在任何作用域都无法找到该变量的情况下),LHS和RHS查询的行为是不一样的。
    
    如果RHS查询在所有嵌套的作用域中遍寻不到所需的变量,引擎就会抛出ReferenceError异常。相比较之下,当引擎执行LHS查询时，
    如果在顶层也没有找到目标变量,全局作用域中就会创建一个具有该名称的变量,并将其返还给引擎。  
    
    在严格模式中,使用LHS查询失败时,引擎会抛出同RHS查询失败时类似的ReferenceError异常。
    
    tips:
    1. ReferenceError 同作用域判断失败相关,而TypeError 则代表作用域判断成功了，但是对结果的操作是非法或不合理的
```js
function foo(a){
    b = 3;
    console.log(a + b);
}
foo(3);
// 6;


function bar(a){
    'use strict';
// LHS查询失败时,引擎会抛出同RHS查询失败时类似的ReferenceError异常。
    b = 3;
    console.log(a + b);
}
bar(3); // ReferenceError
```  
    
