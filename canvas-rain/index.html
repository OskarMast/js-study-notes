<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title>canvas-rain</title>
		<style>
			body{
				padding: 0;
				margin: 0;
				overflow:hidden;
			}
			canvas{
				background-color:#071d3e;
			}
		</style>
	</head>
	<body>
		<canvas></canvas>
		<script>
			const canvas = document.querySelector('canvas');
			const ctx = canvas.getContext('2d');
			// 分别获取浏览器的宽高,分别赋值给canvas,使其与浏览器等宽高.
			let w = window.innerWidth;
			let h = window.innerHeight;
			canvas.width = w;
			canvas.height = h;
			ctx.strokeStyle = '#fff';
			// 当调整浏览器的窗口大小时,再把改变后的窗口大小重新赋值给画布
			window.onresize = function(){
				canvas.width = w;
				canvas.height = h;
				ctx.fillStyle = '#071d3e';
				ctx.strokeStyle = '#fff';
				ctx.fillRect(0,0,w,h);
			}
			ctx.fillStyle = '#071d3e';
			ctx.fillRect(0,0,w,h);
			
			const arr = [];
			for(let i = 0; i < 800; i++){
				arr.push({
					x: Math.random() * w, // 雨滴起始点x坐标
					y: Math.random() * h, // 雨滴起始点y坐标
					endX: Math.random() * 5 - 2, // 雨滴在x轴的偏移
					endY: Math.random() * 20 + 10 // 雨滴的长度
				});
			}
			
			function draw(){
				arr.forEach(function(item){
					// 开始绘制雨滴
					ctx.beginPath();
					ctx.moveTo(item.x,item.y);
					ctx.lineTo(item.x + item.endX,item.y+ item.endY);
					ctx.stroke();
				});
			}
			
			function move(){
				ctx.clearRect(0,0,w,h);
				draw();
				arr.forEach(function(item){
					item.y += item.endY;
					if(item.y > h || item.x > w || item.x < 0){
						item.y = -20;
						item.x = Math.random() * w;
					}
				});
				window.requestAnimationFrame(move);
			}
			move();

		</script>
	</body>
</html>
