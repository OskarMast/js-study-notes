<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>useCallback</title>
</head>
<body>
<div id="app"></div>
<div id="root"></div>
<div id="demo"></div>
<script src="./node_modules/babel-standalone/babel.js"></script>
<script src="./node_modules/react/umd/react.development.js"></script>
<script src="./node_modules/react-dom/umd/react-dom.development.js"></script>
<script type="text/babel">
    function Counter({count}){
        return (
            <h3>{count}</h3>
        )
    }
    function App(){
        const [count,setCount] = React.useState(0);
        const double = (count) => {
            console.log('double render');
            return count * 2;
        }
        const doubleCount = double(count);
        const changeCount = () => {
            setCount(count + 1);
        }
        return (
            <div>
                <button onClick={changeCount}>change</button>
                <p>double-count : {doubleCount}</p>
                <Counter count={count}/>
            </div>
        )
    }
    ReactDOM.render(
        <App/>,
        document.getElementById("app")
    )

    function Root(){
        const [title,setTitle] = React.useState('title');
        const [content,setContent] = React.useState("content");
        const changeTitle = () => {
            setTitle(new Date().getTime());
        }
        const changeContent = () => {
            setContent(new Date().getTime());
        }
        return (
            <div>
                <Bar title={title} content={content}/>
                <button onClick={changeTitle}>changeTitle</button>
                <button onClick={changeContent}>changeContent</button>
            </div>
        )
    }
    function Bar({title,content}){
        function changeTitle(title){
            console.log('changeTitle runs');
            return title + "修改title的方法";
        }
        const otherTitle = changeTitle(title);
        return (
            <div>
                <p>title : {title}</p>
                <p>content : {content}</p>
            </div>
        )
    }
    ReactDOM.render(
        <Root/>,
        document.getElementById("root")
    )



    function Demo(){
        const [count,setCount] = React.useState(1);
        const [value,setValue] = React.useState("");
        const expensive = React.useMemo(() => {
            console.log('computed');
            return () => {
                let sum = 0;
                for(let i = 0; i < count; i++){
                    sum += count;
                }
                return sum;
            }
        },[])
/*        const expensive = React.useCallback(() => {
            console.log("computed");
            let sum = 0;
            for(let i =0; i < count; i++){
                sum += count;
            }
            return sum;
        },[count])*/
        return (
            <div>
                <hr/>
                <p>count : {count}</p>
                <p>value: {value}</p>
                <p>expensive:{expensive()}</p>
                <div>
                    <button onClick={() => setCount(count+1)} children="click"/>
                    <input value={value} onChange={event => setValue(event.target.value)}/>
                </div>
            </div>
        )
    }
    ReactDOM.render(
        <Demo/>,
        document.getElementById("demo")
    )

</script>
</body>
</html>