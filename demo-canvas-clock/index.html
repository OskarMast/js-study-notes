<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title>Canvas时钟</title>
		<style>
			body{
				padding: 0;
				margin: 0;
			}
			body{
				text-align:center;
				background-color:#000;
			}
			canvas{
				margin-top:20px;
			}
		</style>
	</head>
	<body>
		<canvas width='500' height='500'></canvas>
		<script>
			const canvas = document.querySelector('canvas');
			const ctx = canvas.getContext('2d');
			// 先设置绘制的圆的 粗细和颜色,分别表示 时 分 秒中
			ctx.lineWidth = 16;
			ctx.strokeStyle = '#0ff';
			// 给三个圆分别设置阴影
			ctx.shadowColor = '#0ff';
			ctx.shadowBlur = 18;
			/*
		   1. 获取时间,计算小时和时针的关系,1小时是 360/12 = 30 度,当前小时对应的弧度 是 30 * hour * Math.PI / 180
		   2. 分钟对应的角度为 (360 / 60 * min - 90 ) * Math.PI / 180
		   3. 
			*/
		    function move(){
			    const date = new Date();
			   // 分别获取当前的小时,分,秒和毫秒数
			    let hour = date.getHours();
			    // hour = hour > 12 ? (hour-12) : hour;
			    let min = date.getMinutes();
			    let sec = date.getSeconds();
			    let millsec = date.getMilliseconds();
				const startAngle = -90 * Math.PI/180;
				
				const time = {
					'hourAngle':(15 * hour - 90) * Math.PI/180,
					'minAngle':(6 * (min+sec/60) - 90) * Math.PI/180,
					'secAngle':(6 * (sec + millsec/1000) - 90) * Math.PI/180
				}
				ctx.clearRect(0,0,canvas.width,canvas.height);
				// 给canvas设置一个径向渐变
				const gradient = ctx.createRadialGradient(250,250,0,250,250,300);
				gradient.addColorStop(0,'#03303a');
				gradient.addColorStop(1,'#000');
				ctx.fillStyle = gradient;
				ctx.fillRect(0,0,canvas.width,canvas.height);
				ctx.beginPath();
				ctx.arc(250,250,230,startAngle, time.hourAngle ,false);
				ctx.stroke();
				ctx.beginPath();
				ctx.arc(250,250,185,startAngle,time.minAngle , false);
				ctx.stroke();
				ctx.beginPath();
				ctx.arc(250,250,135,startAngle,time.secAngle ,false);
				ctx.stroke();
				
				ctx.fillStyle = '#0ff';
				ctx.font = '22px 微软雅黑';
				ctx.fillText( date.toDateString(),165,240 );
				ctx.fillText( date.toLocaleTimeString() + ':' + millsec ,160,300 );
				
				window.requestAnimationFrame(move);
		   }
		   move();
		</script>
	</body>
</html>
